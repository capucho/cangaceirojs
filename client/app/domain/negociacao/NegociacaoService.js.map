{"version":3,"sources":["../../../app-src/domain/negociacao/NegociacaoService.js"],"names":["HttpService","ApplicationException","Negociacao","NegociacaoService","constructor","_http","obterNegociacoesDaSemana","get","then","dados","map","object","Date","data","quantidade","valor","err","obtemNegociacoesDaSemanaAnterior","obtemNegociacoesDaSemanaRetrasada","obtemNegociacoesDoPeriodo","periodo","Promise","all","reduce","novoArray","item","concat","sort","a","b","getTime","e","console","log"],"mappings":";;AAAA,SAASA,WAAT,EAAsBC,oBAAtB,QAAkD,qBAAlD;AACA,SAASC,UAAT,QAA4B,iBAA5B;;AAEA,WAAaC,iBAAb,GAAO,MAAMA,iBAAN,CAAwB;;AAE7BC,gBAAc;AACZ,SAAKC,KAAL,GAAa,IAAIL,WAAJ,EAAb;AACD;;AAEDM,6BAA2B;AACzB,WAAO,KAAKD,KAAL,CACFE,GADE,CACE,0CADF,EAEFC,IAFE,CAGDC,SAAS;AACP,aAAOA,MAAMC,GAAN,CAAUC,UAAU,IAAIT,UAAJ,CAAe,IAAIU,IAAJ,CAASD,OAAOE,IAAhB,CAAf,EACbF,OAAOG,UADM,EACMH,OAAOI,KADb,CAApB,CAAP;AAED,KANA,EAODC,OAAO;AACL,YAAM,IAAIf,oBAAJ,CAAyB,iDAAzB,CAAN;AACD,KATA,CAAP;AAWD;AACDgB,qCAAmC;AACjC,WAAO,KAAKZ,KAAL,CACNE,GADM,CACF,4CADE,EAENC,IAFM,CAGLC,SAAS;AACP,aAAOA,MAAMC,GAAN,CAAUC,UAAU,IAAIT,UAAJ,CAAe,IAAIU,IAAJ,CAASD,OAAOE,IAAhB,CAAf,EACbF,OAAOG,UADM,EACMH,OAAOI,KADb,CAApB,CAAP;AAED,KANI,EAOLC,OAAO;AACL,YAAM,IAAIf,oBAAJ,CAAyB,0DAAzB,CAAN;AACD,KATI,CAAP;AAWD;;AAEDiB,sCAAoC;AAClC,WAAO,KAAKb,KAAL,CACNE,GADM,CACF,6CADE,EAENC,IAFM,CAGLC,SAAS;AACP,aAAOA,MAAMC,GAAN,CAAUC,UAAU,IAAIT,UAAJ,CAAe,IAAIU,IAAJ,CAASD,OAAOE,IAAhB,CAAf,EACbF,OAAOG,UADM,EACMH,OAAOI,KADb,CAApB,CAAP;AAED,KANI,EAOLC,OAAO;AACL,YAAM,IAAIf,oBAAJ,CAAyB,2DAAzB,CAAN;AACD,KATI,CAAP;AAWD;;AAEKkB,2BAAN,GAAkC;AAAA;;AAAA;;AAEhC,UAAI;AACF,YAAIC,UAAU,MAAMC,QAAQC,GAAR,CAAY,CAC9B,MAAKhB,wBAAL,EAD8B,EAE9B,MAAKW,gCAAL,EAF8B,EAG9B,MAAKC,iCAAL,EAH8B,CAAZ,CAApB;;AAMA,eAAOE,QAAQG,MAAR,CAAe,UAACC,SAAD,EAAYC,IAAZ;AAAA,iBAAqBD,UAAUE,MAAV,CAAiBD,IAAjB,CAArB;AAAA,SAAf,EAA4D,EAA5D,EACEE,IADF,CACO,UAACC,CAAD,EAAGC,CAAH;AAAA,iBAASA,EAAEhB,IAAF,CAAOiB,OAAP,KAAmBF,EAAEf,IAAF,CAAOiB,OAAP,EAA5B;AAAA,SADP,CAAP;AAED,OATD,CASE,OAAMC,CAAN,EAAS;AACTC,gBAAQC,GAAR,CAAYF,CAAZ;AACA,cAAM,IAAI9B,oBAAJ,CAAyB,kDAAzB,CAAN;AACD;AAd+B;AAgBjC;AA/D4B,CAA/B","file":"NegociacaoService.js","sourcesContent":["import { HttpService, ApplicationException } from '../../util/index.js';\nimport { Negociacao }  from './Negociacao.js';\n\nexport class NegociacaoService {\n\n  constructor() {\n    this._http = new HttpService();\n  }\n\n  obterNegociacoesDaSemana() {\n    return this._http\n        .get('http://localhost:3000/negociacoes/semana')\n        .then(\n          dados => {\n            return dados.map(object => new Negociacao(new Date(object.data), \n                          object.quantidade, object.valor));\n          },\n          err => {\n            throw new ApplicationException('Nao foi possivel obter as negociacoes da semana');\n          }\n        );\n  }\n  obtemNegociacoesDaSemanaAnterior() {\n    return this._http\n    .get('http://localhost:3000/negociacoes/anterior')\n    .then(\n      dados => {\n        return dados.map(object => new Negociacao(new Date(object.data), \n                      object.quantidade, object.valor));\n      },\n      err => {\n        throw new ApplicationException('Nao foi possivel obter as negociacoes da semana anterior');\n      }\n    );\n  }\n\n  obtemNegociacoesDaSemanaRetrasada() {\n    return this._http\n    .get('http://localhost:3000/negociacoes/retrasada')\n    .then(\n      dados => {\n        return dados.map(object => new Negociacao(new Date(object.data), \n                      object.quantidade, object.valor));\n      },\n      err => {\n        throw new ApplicationException('Nao foi possivel obter as negociacoes da semana retrasada');\n      }\n    );\n  }\n\n  async obtemNegociacoesDoPeriodo() {\n    \n    try {\n      let periodo = await Promise.all([\n        this.obterNegociacoesDaSemana(),\n        this.obtemNegociacoesDaSemanaAnterior(),\n        this.obtemNegociacoesDaSemanaRetrasada()\n      ]);\n\n      return periodo.reduce((novoArray, item) => novoArray.concat(item), [])\n              .sort((a,b) => b.data.getTime() - a.data.getTime());\n    } catch(e) {\n      console.log(e);\n      throw new ApplicationException('Nao foi possivel obter as negociacoes do periodo');\n    }\n    \n  }\n}"]}